screeplot.spca(pp)
colorplot.spca(pp,pch=19,cex=2)
NCH.gp <- genind2genpop(NCH.genot)
Xfreq <- makefreq(NCH.gp,missing="mean")
NCH.HW<-HWE.test(NCH.genot)
#---------------------------------------------------------------------------
# Spatial
?dist
library(fossil)
earth.dist(xy)
plot(dst)
?monmonier
plot(mon1,xy)
NCH.gp
pca1 <- dudi.pca(NCH.gp@tab,scale=FALSE, scannf=FALSE, nf=1)
?dudi.pca
NCH.gp@tab
pca1 <- dudi.pca(NCH.gp@tab,scale=FALSE, scannf=FALSE, nf=3)
pca1 <- dudi.pca(NCH.gp@tab,scale=FALSE, scannf=T, nf=3)
pca1 <- dudi.pca(NCH.gp@tab,, center = TRUE,
scale = TRUE, scan = FALSE)
plot(mon1,NCH.genot@tab)
load(system.file("files/mondata1.rda",package="adegenet"))
mondata1$x1
str(mondata1$x1)
summary.spca(pp)
?spca
pp$li
mon1 <- monmonier(xy,dist(pp$li[,1]),cn1,threshold=2)
plot(mon1,mondata1$x1)
plot(mon1,pp$li[,1],met="greylevel",add.arr=FALSE,col="red",bwd=6,lty=2)
plot(mon1,pp$li[,1],met="greylevel",add.arr=T,col="red",bwd=2,lty=2)
plot(mon1,pp$li[,1],met="greylevel",add.arr=T,col="red",bwd=6,cex=2,lty=2)
plot(mon1,pp$li[,2])
mon1 <- monmonier(xy,cn1,threshold=5)
mon1 <- monmonier(xy,cn1,threshold=2)
cn1
xy=cbind(NCH.genot@other[,2],NCH.genot@other[,3])
cn1 <- chooseCN(xy,type=2,ask=FALSE)
mon1 <- monmonier(xy,dst,cn1,threshold=2)
plot(mon1,met="greylevel",add.arr=FALSE,col="red",bwd=6,lty=2))
mon2 <- monmonier(xy,dist(pp$li[,1]),cn1,threshold=2)
plot(mon1,pp$li[,1])
plot(mon2)
plot(mon1,met="greylevel",add.arr=FALSE,col="red",bwd=6,lty=2)
plot(mon2,pp$li[,1])
plot(mon1,pp$li[,1],met="greylevel",add.arr=T,col="red",bwd=6,lty=2)
plot(mon2,pp$li[,1],met="greylevel",add.arr=T,col="red",bwd=6,lty=2)
plot(mon2,met="greylevel",add.arr=FALSE,col="red",bwd=6,lty=2)
rm(pp,mondata1)
plot(cn1)
plot(mon1)
plot(mon1,add.arr=F)
plot(mon2,add.arr=F)
data(veronica)
vei
vei <- prabinit(prabmatrix=veronica[1:50,],distance="jaccard")
ppv <- prabclust(vei)
veronica
veloci <- prabinit(prabmatrix=veronica[1:50,],rows.are.species=FALSE)
velociclust <- prabclust(veloci,nnk=0)
lociplots(ppv,velociclust$clustering,veloci,lcluster=3)
ppv<-prabclust(dst)
data(tetragonula)
tnb <-
coord2dist(coordmatrix=tetragonula.coord[1:50,],cut=50,file.format="decimal2",neighbors=TRUE)
ta <- alleleconvert(strmatrix=tetragonula[1:50,])
tai <- alleleinit(allelematrix=ta,neighborhood=tnb$nblist)
View(veronica)
library(adegenet);library(genetics);library(spdep);library(prabclus)
library(ade4)
if (require(maptools, quiet = TRUE) & require(spdep, quiet = TRUE)) {
data(mafragh)
maf.listw <- nb2listw(neig2nb(mafragh$neig))
maf.pca <- dudi.pca(mafragh$mil, scannf = FALSE)
multispati.rtest(maf.pca, maf.listw)
maf.pca.ms <- multispati(maf.pca, maf.listw, scannf=FALSE)
plot(maf.pca.ms)
}
library(ade4); library(mpmcorrelogram)
data(Zd)
View(Zd)
?Zd
setwd("~/Documents/Working/MS_Prunus_Dispersal patterns/Data")
load("~/Documents/Working/MS_Prunus_Dispersal patterns/Data/.RData")
all <- alleleconvert(strmatrix=NCH.genot@tab)
tetragonula[1:50,]
pp<-read.table("NCH_genot.txt",header=T,sep="\t",dec=".",na.strings="NA")
pp
str(pp)
all <- alleleconvert(strmatrix=pp[2:12,])
allele<-read.table("NCH_allele.txt",header=T,sep="\t",dec=".",na.strings="NA")
all <- alleleconvert(strmatrix=allele[2:12,])
tetragonula
str(alleleconvert(strmatrix=allele[,2:12]))
all
coord2dist(coordmatrix=xy,file.format="decimal2",neighbors=TRUE)
?coord2dist
coord2dist(coordmatrix=xy,file.format="decimal2",cut=0.5,neighbors=TRUE)
tai <- alleleinit(allelematrix=ta,neighborhood=tnb$nblist,distance="none")
dist<-coord2dist(coordmatrix=xy,file.format="decimal2",cut=0.5,neighbors=TRUE)
tai <- alleleinit(allelematrix=ta,neighborhood=all$nblist,distance="none")
str(all)
tai <- alleleinit(allelematrix=all,neighborhood=all$nblist,distance="none")
nbtest(all)
tai <- alleleinit(allelematrix=all,neighborhood=NULL,distance="alleledist")
tai <- alleleinit(allelematrix=all,neighborhood=""none,distance="alleledist")
print(tai)
plot(tai)
str(alleledist((unbuild.charmatrix(tai$charmatrix,50,13)),50,13))
str(alleledist((unbuild.charmatrix(tai$charmatrix,30,13)),30,13))
str(dst)
library(raster)
#Make a distance matrix
xy
pointDistance
(pp$li[,1])
pp$li[,1]
pp<-spca(NCH.genot, xy=cbind(NCH.genot@other[,2],NCH.genot@other[,3]),
scale=F,scale.method="sigma",cn=NULL,
scannf=F, nfposi=1, nfnega=1,
type=1, ask=F, plot.nb=TRUE, edit.nb=FALSE,
truenames=TRUE, d1=NULL, d2=NULL, k=NULL, a=NULL, dmin=0.01)
dist<-coord2dist(coordmatrix=xy,file.format="decimal2",cut=0.1,neighbors=TRUE)
dist
dim(dist)
length(dist)
all <- alleleconvert(strmatrix=allele[,2:12])
tai <- alleleinit(allelematrix=all,neighborhood="none",distance="alleledist")
tai <- alleleinit(allelematrix=all)
print(prabclust(tai))
result <- mpmcorrelogram(tai, dist, simil=TRUE)
distance<-coord2dist(coordmatrix=xy,file.format="decimal2",cut=0.1,neighbors=TRUE)
result <- mpmcorrelogram(tai, as.dist(distance), simil=TRUE)
data(S)
data(D)
result <- mpmcorrelogram(S, D, simil=TRUE)
is.dist(dst)
dst
dst <- as.dist(dst)
mpmcorrelogram
dst <- pointDistance(xy, longlat=F)
result <- mpmcorrelogram(tai, dst, simil=TRUE)
?double
result <- mpmcorrelogram(tai, as.double(dst), simil=TRUE)
result <- mpmcorrelogram(as.double(tai), as.double(dst), simil=TRUE)
?vegan
library(vegan)
vegdist(xy,methos="euclidean")
D<-vegdist(xy,method="euclidean")
str(D)
plot(D)
result <- mpmcorrelogram(tai, D, simil=TRUE)
tai
tai$amatrix
S<-vegdist(tai$amatrix,method="jaccard")
?alleleint
?alleleinit
tai$distmat
result <- mpmcorrelogram(tai$distmat, D, simil=TRUE)
?mpmcorrelogram
result <- mpmcorrelogram(tai$distmat, D, permutations = 99, simil=F)
1022/100
30*50
30*45
30*35
permutations = 99, simil=T, nclass=35)
permutations = 999, simil=F, nclass=70)
permutations = 99, simil=F, nclass=70)
permutations = 99, simil=F, nclass=30)
permutations = 99, simil=T, nclass=30)
result <- mpmcorrelogram(tai$distmat, D,
permutations = 99, simil=T, nclass=12)
hist(D)
prabclust(tai)
?prabclust
?prabinit
clusters<-prabclust(tai)
clusters$clustsummary
clusters$clustering
clusters$points
ls()
plot(rnorm(200),rnorm(200))
plot(coor$y, coor$x,
xlim=c(0,400),ylim=c(0,1200))
?install.packages
library(ecespa); library(spatial); library(spatstat); library(gstat)#
library(sgeostat); library(MASS)
bei
par(mfrow=c(1,2))#
quadratcount(bei, nx = 6, ny = 3) #
Q <- quadratcount(bei, nx = 6, ny = 3)
plot(bei, cex = 0.5, pch = "+")
plot(Q, add = TRUE, cex = 2)
M <- quadrat.test(bei, nx = 6, ny = 3)
M
plot(Q)
plot(M, add = TRUE, cex = 1)
?quadrat.test
den <- density(bei, sigma = 70)
plot(den)
plot(bei, add = TRUE, cex = 0.5)
persp(den)
contour(den)
plot(lansing)
str(lansing)
head(lansing)
ppm(lansing, ~ marks, Poisson())
data(bei)
str(bei)
fit <- ppm(bei, ~slope, covariates = slope)
fit <- ppm(bei, ~slope, covariates = grad)
fit <- ppm(bei, ~slope, covariates = list(grad))
?ppm
library(deldir)
hick <- split(lansing)$hickory
hick.tr<-deldir(hick$x,hick$y)
par(mfrow=c(1,3))
plot(hick)
plot(delaunay(hick))
plot(hick.tr)
library(ape); library(ade4)
tree.primates <- read.tree(text="((((Homo:0.21,Pongo:0.21):0.28,Macaca:0.49):0.13,Ateles: 0.62):0.38,Galago:1.00);")
body <- c(4.09434,3.61092,2.37024,2.02815,-1.46968)#
longevity <- c(4.74493,3.3322,3.3673,2.89037,2.30259)
plot(body,longevity)
names(body)<-names(longevity)<-c("Homo","Pongo","Macaca","Ateles","Galago")
pic.body <- pic(body,tree.primates)#
pic.longevity <- pic(longevity,tree.primates)
pic.body
plot(tree.primates)
nodelabels(round(pic.body,3),adj=c(0,0.5),frame="n")#
nodelabels(round(pic.longevity,3),adj=c(0,2),frame="n")
par(mfrow=c(2,1))#
plot(body,longevity)#
plot(pic.body,pic.longevity,pch=19)#
abline(0,1,lty=2)
data(carnivora)
names(carnivora)
library(nlme)
m <- lme(log10(SW) ~ 1, random = ~ 1|Order/SuperFamily/Family/Genus, data=carnivora)#
v <- varcomp(m, TRUE, TRUE)
plot(v)
data("landplants.newick")
landplants.newick
tree.landplants <- read.tree(text = landplants.newick)
plot(tree.landplants, label.offset = 0.001)
plot(tree.landplants, label.offset = 0.001,cex=2)
plot(tree.landplants, label.offset = 0.001, type="radial")
trape<-read.tree(text="((Homo,Pan),Gorilla);")
plot(trape,x.lim=c(-0.1,2.2))
nodelabels(c("6.4 Ma","5.4 Ma"),frame="c",bg="white")
#
data(bird.families)#
zoom(bird.families,list(1:15,38:48),col=rep("grey",2),no.margin=TRUE,font=1,subtree=TRUE)
data(palm)
palm.phy <- newick2phylog(palm$tre)
palm.phy
radial.phylog(palm.phy,clabel.l=1.25)
table.phylog(tt, palm.phy, clabel.r = 0.7, f = 0.4)
tt<-cbind.data.frame(scalewt((palm$traits[,c(2,4:7)])))#
table.phylog(tt, palm.phy, clabel.r = 0.7, f = 0.4)
?barplot
