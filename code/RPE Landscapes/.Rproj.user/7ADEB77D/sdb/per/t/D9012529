{
    "collab_server" : "",
    "contents" : "---\ntitle: \"RPE for each species\"\nauthor: \"Elena Quintero\"\noutput: html_document\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n```{r}\n#Call requiered packages\nlibrary(readr)\nlibrary(effect.lndscp)\nlibrary(devtools)\nlibrary(ggplot2)\nlibrary(ggrepel)\n```\n\nProblems to solve:\n- Error bars out of graph\n- Name of isolines - move further right\n- Choose apropriate visualization when too many species points:\n    - Use numbers and legend\n    - Change to shorter names\n    - Grouping for plant families\n    - Avoid clustering - ggrepel options\n\n\n#CRACIDAE\nDone for Penelope and Aburria together as there is few data. \n```{r}\n#Import data\nCracidae <- read_delim(\"Cracidae.csv\", \";\", escape_double = FALSE, \n                      col_types = cols(plant = col_factor(levels = c()), \n                      plant_family = col_factor(levels = c()), \n                      species = col_factor(levels = c())), trim_ws = TRUE)\nstr(Cracidae)\nnames(Cracidae)\n```\n\nRPE here is based on: QTY component (visit_freq*fruits_visit) and QLY (fruit energy). Therefore there is no variation in Y axis\n```{r}\n#RPE for Cracids\nCracid <- subset(Cracidae, Cracidae$QTY > 0) #Select rows for which we have data\nCracid\nRPE2_Cracidae <- effectiveness_plot(Cracid$QTY, Cracid$energy_fruit, , \n                                    Cracid$plant, 10, \n                                    myxlab= \"Qty component - feeding frequency (fruits/h)\", \n                                    myylab= \"Qly component - energy (KJ/fruit)\")\n# Include SE bars and colors for each species\n# PEDRO: I've added xlim and ylim; does not seem to work well...\nRPE2_Cracidae + geom_errorbarh(aes(xmin = Cracid$QTY - Cracid$QTY_SE,xmax = Cracid$QTY + Cracid$QTY_SE), height=0.3) + \n                geom_point(aes(colour = factor(Cracid$species)), size=3) +\n                coord_cartesian(xlim=c(0, 0.62), ylim=c(0, 16))\n```\n\nUsing estimated number of fruits/visit from regression. \nNectandra and Phytolacca sp get very high estimates as they are small fruits - probably unrealistic\n```{r}\n#RPE for Cracids using fruits/visit and energy/fruit\n#Overcomming missing data for visitation frequency and from estimated fruits/visit\nCracidae\nRPE_Cracidae <- effectiveness_plot(Cracidae$fruit_visit, Cracidae$energy_fruit, , \n                                   Cracidae$plant, 10, \n                                   myxlab= \"Qty component - feeding frequency (fruits/visit)\", \n                                   myylab= \"Qly component - energy (KJ/fruit)\")\n#Include SE bars and colors for each species\nRPE_Cracidae + geom_errorbarh(aes(xmin = Cracidae$fruit_visit - Cracidae$fruit_visit_SE, xmax = Cracidae$fruit_visit + \n              Cracidae$fruit_visit_SE), height=0.3)+ \n              geom_point(aes(colour = factor(Cracidae$species)), size=3)\n```\n\nTo add Y axis variability in this RPE, the QLY component is (fruit specific energy*PDM/FFRM*frug_capacity/fruits_visit).\nProblem: hard to explain this intraespecific variability\n```{r}\nCracidae\nRPE_Cracidae2 <- effectiveness_plot(Cracidae$fruit_visit, Cracidae$QLY, , \n                                   Cracidae$plant, 10, \n                                   myxlab= \"Qty component - feeding frequency (fruits/visit)\", \n                                   myylab= \"Qly component - energy (KJ/fruit)\")\n#Include SE bars and colors for each species\nRPE_Cracidae2 + geom_errorbar(aes(ymin= Cracidae$QLY - Cracidae$QLY_SE, ymax=Cracidae$QLY + Cracidae$QLY_SE), width=.02)+ \n              geom_errorbarh(aes(xmin = Cracidae$fruit_visit - Cracidae$fruit_visit_SE, xmax = Cracidae$fruit_visit +\n              Cracidae$fruit_visit_SE),height=0.3)+ \n              geom_point(aes(colour = factor(Cracidae$species)), size=3)\n```\n\nIssue: RPE with QLY variability and without variability is different! - specially for cases as Cecropia\n\n\n\n\n\n\n\n\n\n\n#RAMPHASTIDAE\n```{r}\n#Import data\nToucans <- read_delim(\"Toucans.csv\", \";\", escape_double = FALSE, \n                    col_types = cols(plant = col_factor(levels = c()), \n                    plant_family = col_factor(levels = c()), \n                    species = col_factor(levels = c())), trim_ws = TRUE)\n\n#Subset for each toucan species\nBaillonus <- subset(Toucans, species == \"Baillonius bailloni\")\nR_dicol <- subset(Toucans, species == \"Ramphastos dicolorus\")\nR_vitel <- subset(Toucans, species == \"Ramphastos vitellinus\")\nSelenidera <- subset(Toucans, species == \"Selenidera maculirostris\")\n```\n\n```{r}\n#RPE for all Toucans together\nRPE_toucans <- effectiveness_plot(Toucans$QTY, Toucans$energy_fruit,, \n                Toucans$plant, 10, \n                myxlab= \"Qty component - feeding frequency (fruits/h)\", \n                myylab= \"Qly component - energy (KJ/fruit)\")\nRPE_toucans +   geom_errorbarh(aes(xmin = Toucans$QTY - Toucans$QTY_SE, xmax = Toucans$QTY + Toucans$QTY_SE), height=0.3)+\n                geom_point(aes(colour = factor(Toucans$species)), size=3)\n```\n\n##Baillonius bailloni \nDifferent RPEs if variation in QLY or not.\n```{r}\n#RPE landscape for Baillonius bailloni with QLY variation\nRPE_Baillonus <- effectiveness_plot(Baillonus$QTY, Baillonus$QLY, \n                Baillonus$plant_family, \n                Baillonus$plant, 10, \n                myxlab= \"Qty component - feeding frequency (fruits/h)\", \n                myylab= \"Qly component - energy (KJ/fruit)\")\nRPE_Baillonus + geom_errorbar(aes(ymin= Baillonus$QLY - Baillonus$QLY_SE,ymax=Baillonus$QLY + Baillonus$QLY_SE),width=.02) +   \n                geom_errorbarh(aes(xmin = Baillonus$QTY - Baillonus$QTY_SE, xmax = Baillonus$QTY + Baillonus$QTY_SE), height=0.3)+\n                geom_point(aes(colour = factor(Baillonus$plant_family)), size=3)\n\n\n#RPE landscape for Baillonius bailloni without QLY variation\nRPE_Baillonus2 <- effectiveness_plot(Baillonus$QTY, Baillonus$energy_fruit, \n                  Baillonus$plant_family, Baillonus$plant, 10,\n                  myxlab= \"Qty component - feeding frequency (fruits/h)\",\n                  myylab= \"myylab(KJ/fruit)\")\nRPE_Baillonus2 + geom_errorbarh(aes(xmin = Baillonus$QTY - Baillonus$QTY_SE, xmax = Baillonus$QTY + Baillonus$QTY_SE),height=0.3)+\n                  geom_point(aes(colour = factor(Baillonus$plant_family)), size=3)\n```\n\n##Ramphastos dicolorus\n```{r}\nRPE_R_dicol <- effectiveness_plot(R_dicol$QTY, R_dicol$QLY, R_dicol$plant_family, \n                R_dicol$plant, 10, \n                myxlab= \"Qty component - feeding frequency (fruits/h)\", \n                myylab= \"Qly component - energy (KJ/fruit)\")\nRPE_R_dicol + geom_errorbar(aes(ymin= R_dicol$QLY - R_dicol$QLY_SD, ymax=R_dicol$QLY+ R_dicol$QLY_SD), width=.02) +\n              geom_errorbarh(aes(xmin = R_dicol$QTY - R_dicol$QTY_SD,xmax = R_dicol$QTY + R_dicol$QTY_SD), height=0.3)\n\n\n```\n\nRPE change with digestibility values\n```{r}\n#Data \nToucans2 <- read_delim(\"Toucans_digest.csv\", \";\", escape_double = FALSE, \n                    col_types = cols(plant = col_factor(levels = c()), \n                    plant_family = col_factor(levels = c()), \n                    species = col_factor(levels = c())), trim_ws = TRUE)\n#INCLUDING DIGESTIBILITY VALUES\nR_dicol2 <- subset(Toucans2, species == \"Ramphastos dicolorus\")\nRPE_R_dicol_digest <- effectiveness_plot(R_dicol2$QTY, R_dicol2$QLY, R_dicol2$plant_family, \n                R_dicol2$plant, 10, \n                myxlab= \"Qty component - feeding frequency (fruits/h)\", \n                myylab= \"Qly component - energy (KJ/fruit)\")\nRPE_R_dicol_digest + geom_errorbar(aes(ymin= R_dicol2$QLY - R_dicol2$QLY_SD, ymax=R_dicol2$QLY+ R_dicol2$QLY_SD), width=.02) +\n              geom_errorbarh(aes(xmin = R_dicol2$QTY - R_dicol2$QTY_SD,xmax = R_dicol2$QTY + R_dicol2$QTY_SD), height=0.3)+\n              geom_point(aes(x=R_dicol2$QTY[2],y=R_dicol2$QLY[2]), colour=\"red\", size=2)+\n              geom_point(aes(x=R_dicol2$QTY[6],y=R_dicol2$QLY[6]), colour=\"blue\", size=2)\n```\nWhen including digestibility the points go further down in the quality scale\n",
    "created" : 1499873666663.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1956735105",
    "id" : "D9012529",
    "lastKnownWriteTime" : 1499887724,
    "last_content_update" : 1499887724053,
    "path" : "~/Documents/Working/MSS_Elena_master/code/RPE Landscapes/Each frugivore.Rmd",
    "project_path" : "Each frugivore.Rmd",
    "properties" : {
        "last_setup_crc32" : ""
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}