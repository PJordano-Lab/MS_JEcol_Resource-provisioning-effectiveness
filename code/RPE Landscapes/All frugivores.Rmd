---
title: "RPE Landscape for frugivores"
author: "Elena Quintero"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Read data
library(readr)
frug <- read_delim("all_frug.csv", ";", escape_double = FALSE, col_types = cols(plant_family = col_factor(levels = c()), species = col_factor(levels = c())),  trim_ws = TRUE)
names(frug)
```

```{r}
#Install requiered packages
library(effect.lndscp)
library(devtools)
library(ggplot2)
library(ggrepel)
#Execute RPE lanscape
RPE_frug <- effectiveness_plot(frug$QTY, frug$QLY, frug$plant_family,
                                   frug$species,10, 
                                   myxlab= "Qty component (fruits/hour)", 
                                   myylab= "Qly component (KJ/fruit)")
RPE_frug
#to include Standard error bars
RPE_frug + geom_errorbar(aes(ymin= frug$QLY - frug$QLY_SE, ymax=frug$QLY + frug$QLY_SE), width=.02)+ 
            geom_errorbarh(aes(xmin = frug$QTY - frug$QTY_SE, xmax = frug$QTY + frug$QTY_SE), height=0.3)
```

This RPE has variability in the Y-axis (QTY component) - coming from QLY = specific energy*PDM/FFRM*frug_capacity/fruits_visit. 
Cecropia pachystachia has a very high Quality component - because the fruit_visit are very low (like 0.003). 
Main problem: too many plant species, all together
Other problem: SE error bar for Cecropia pachystachia QLY doesn't appear (out of y limit)

```{r}
#RPE landscape with no variability in QTY (fruit energy)
RPE_frug_energy <- effectiveness_plot(frug$QTY, frug$energy_fruit, frug$plant_family,
                               frug$species,10, 
                               myxlab= "Qty component (fruits/hour)", 
                               myylab= "Qly component (KJ/fruit)")
RPE_frug_energy
#Including error bars
RPE_frug_energy + geom_errorbarh(aes(xmin = frug$QTY - frug$QTY_SE, xmax = frug$QTY + frug$QTY_SE), height=0.3)
```

The points are better distributed along y axis, but still hard to read names, and see point shapes.

```{r}
#Including colors for families instead of shapes
RPE_frug_energy <- effectiveness_plot(frug$QTY, frug$energy_fruit, , #here we dont specify points shape
                               frug$species,10, 
                               myxlab= "Qty component (fruits/hour)", 
                               myylab= "Qly component (KJ/fruit)")
RPE_frug_energy + geom_errorbarh(aes(xmin = frug$QTY - frug$QTY_SE, xmax = frug$QTY + frug$QTY_SE), height=0.3)+
                  geom_point(aes(colour = factor(frug$plant_family)), size=3)
```
Problem - too many colors hard to distinguish.


Conclusions
-----------
- Include variability in QLY component?
- What to do for Cecropia pachystachya outlayer?
- Better to include numbers in each point and create a legend for species.  
- Reduce lenght name of plant species
- Reduce plant species selected


